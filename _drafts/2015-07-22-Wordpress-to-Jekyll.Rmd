---
layout: post
title: "Wordpress에서 Jekyll로..."
date: 2015-07-22
categories: R
tags: [R, servr, knitr, Jekyll]
comments: true
---

```{r eval=TRUE, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  error = TRUE,
  tidy = FALSE,
  width = 60
)

options(digits = 3)
```

약 10년을 써오던 설치형 [워드프레스](http://wordpress.org)를 버리고 [Github Page](https://pages.github.com)에서 제공하는 [Jekyll](http://jekyllrb.com)기반의블로그로 이동하였다. Github Page와 Jekyll을 이용하여 블로깅을 하는 방법과 장점에 대해서는 인터넷에 잔뜩 널려있으니 여기서는 자세한 설명을 생략하기도 하고 이 블로그의 주된 주제인 데이터 분석, 특히 R 코드 및 수식이 들어간 글을 쉽게 Jekyll 문법에 맞게 포스팅할 수 있는가 하는 방법에 대해 정리하도록 한다.

이동 전까지 R 코드가 포함된 모든글을 [RStudio](http://www.rstudio.com)에서 rmarkdown을 이용해 작성 -> html 변환 -> 워드프레스 에디터에서 최종편집하는 과정을 거쳤는데 이것도 불편.

`knitr` 패키지의 저자가 servr + knitr 페키지를 이용하여 로컬 Jekyll 사이트를 구축하는 [방법을 공개](http://yihui.name/knitr-jekyll/2014/09/jekyll-with-knitr.html)하여 이를 이용한다.

일반적으로 Jekyll을 사용하는 많은 이들이 `redcarpet`을 markdown 엔진으로 사용하는데 포스트에 가끔 들어가는 [Mathjax](https://www.mathjax.org)을 이용한 `$$ 수식 $$`이 제대로 표시되지 않는 문제가 있다. 대안으로 `kramdown`을 사용하면 그 문제가 해결되는데 다만 **```**로 시작하는 코드 삽입을 할 수 없고 `{% highlight lang %} {% endhighlight %}`으로 코드의 시작과 끝을 알려 주어야한다. 친절하게도 이에대한 해결 방법도 제공해 주어서 다음과 같은 내용의 `build.R` 파일을 작성하여 로컬 Jekyll 사이트에 저장하고

```{r eval = FALSE}
## Serve Jekyll Websites with servr and knitr
## from http://yihui.name/knitr-jekyll/2014/09/jekyll-with-knitr.html

local({
  # fall back on '/' if baseurl is not specified
  baseurl = servr:::jekyll_config('.', 'baseurl', '/')
  knitr::opts_knit$set(base.url = baseurl)
  # fall back on 'kramdown' if markdown engine is not specified
  markdown = servr:::jekyll_config('.', 'markdown', 'kramdown')
  # see if we need to use the Jekyll render in knitr
  if (markdown == 'kramdown') {
    knitr::render_jekyll()
  } else knitr::render_markdown()

  # input/output filenames are passed as two additional arguments to Rscript
  a = commandArgs(TRUE)
  d = gsub('^_|[.][a-zA-Z]+$', '', a[1])
  knitr::opts_chunk$set(
    fig.path   = sprintf('figs/%s/', d),
    cache.path = sprintf('cache/%s/', d)
  )
  knitr::opts_knit$set(width = 70)
  knitr::knit(a[1], a[2], quiet = TRUE, encoding = 'UTF-8', envir = .GlobalEnv)
})
```

R 콘솔에서
```{r eval = FALSE, prompt=TRUE}
servr::jekyll()
```
을 실행하면 로컬 머신의 Jekyll 사이트를 빌드해 준다.

